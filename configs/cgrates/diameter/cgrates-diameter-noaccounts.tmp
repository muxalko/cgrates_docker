{
    "diameter_agent": {
        "enabled": true,                                                // enables the diameter agent: <true|false>                                 
		"listen_net":"*env:DA_LISTEN_NET",
        "listen": "*env:DA_LISTEN",									// address where to listen for diameter requests <x.y.z.y:1234>
		"dictionaries_path": "/etc/cgrates/diameter/dict/",        // path towards directory holding additional dictionaries to load
        "sessions_conns": [
            //    {"address": "*internal"}                                // connection towards SessionService
                {"address": "*env:SESS_ADDR","transport":"*json"},
        ],                                     
        "origin_host": "*env:DA_ORIGIN_HOST",                           // diameter Origin-Host AVP used in replies
        "origin_realm": "*env:DA_ORIGIN_REALM",                         // diameter Origin-Realm AVP used in replies
        //"vendor_id": 0,                                               // diameter Vendor-Id AVP used in replies
        "product_name": "*env:DA_PRODUCT_NAME",                         // diameter Product-Name AVP used in replies
        
		"templates":{
            "*cca": [
                    {"tag": "SessionId",              "field_id": "Session-Id",             "type": "*composed", "value": "~*req.Session-Id",           "mandatory": true},
                    {"tag": "OriginHost",             "field_id": "Origin-Host",            "type": "*composed", "value": "~*vars.OriginHost",          "mandatory": true},
                    {"tag": "OriginRealm",            "field_id": "Origin-Realm",           "type": "*composed", "value": "~*vars.OriginRealm",         "mandatory": true},
                    {"tag": "AuthApplicationId",      "field_id": "Auth-Application-Id",    "type": "*composed", "value": "~*vars.*appid",              "mandatory": true},
                    {"tag": "CCRequestType",          "field_id": "CC-Request-Type",        "type": "*composed", "value": "~*req.CC-Request-Type",      "mandatory": true},
                    {"tag": "CCRequestNumber",        "field_id": "CC-Request-Number",      "type": "*composed", "value": "~*req.CC-Request-Number",    "mandatory": true},
                    {"tag": "ResultCode", 			  "field_id": "Result-Code",            "type": "*constant", "filters": ["*rsr::~*cgrep.Error(!^$)"], "value": "5031", "blocker": true},
					{"tag": "ResultCode", 			  "field_id": "Result-Code",            "type": "*constant", "filters": ["*rsr::~*cgrep.Attributes.Category(^$)"], "value": "5030", "blocker": true},
					
            ],
            "cca-custom": [
                    {"tag": "RatingGroup", "field_id": "Multiple-Services-Credit-Control.Rating-Group",            "type": "*constant", "value": "1"},
                    {"tag": "ServiceId",   "field_id": "Multiple-Services-Credit-Control.Service-Identifier",      "type": "*constant", "value": "1"},
                    {"tag": "ValidityTime","field_id": "Multiple-Services-Credit-Control.Validity-Time",           "type": "*constant", "value": "600"},
					
            ]
        },
        
        "request_processors": [
        {
                "id": "data_init",
                "filters": ["*string:*vars.*cmd:CCR", "*string:*req.CC-Request-Type:1", "*string:*req.Service-Context-Id:7.32251@3gpp.org"],
                "flags": ["*initiate", "*attributes"],
                "request_fields":[
                    {"tag": "TOR",          "field_id": "ToR",              "type": "*constant",    "value": "*data",                 "mandatory": true},
                    {"tag": "OriginHost",   "field_id": "OriginHost",       "type": "*composed",    "value": "~*req.Origin-Host",     "mandatory": true},
                    {"tag": "OriginID",     "field_id": "OriginID",         "type": "*composed",    "value": "~*req.Session-Id",      "mandatory": true},
                    {"tag": "RequestType",  "field_id": "RequestType",      "type": "*composed",    "value": "*prepaid",             "mandatory": true},
                    {"tag": "Direction",    "field_id": "Direction",        "type": "*composed",    "value": "*out",                 "mandatory": true},
                    {"tag": "Tenant",       "field_id": "Tenant",           "type": "*composed",    "value": "golant",               "mandatory": true},
                    //{"tag": "Category",     "field_id": "Category",         "type": "*composed",    "value": "data",                 "mandatory": true},
                    {"tag": "Category",     "field_id": "Category",         "type": "*composed",    "value": "*attributes",           "mandatory": true},
                    {"tag": "MSISDN",      	"field_id": "MSISDN",          	"type": "*composed",    "value": "~*req.Subscription-Id.Subscription-Id-Data[~Subscription-Id-Type(0)]", "mandatory": true },
                    {"tag": "MCCMNC",  		"field_id": "MCCMNC",      		"type": "*composed",    "value": "~*req.Service-Information.PS-Information.3GPP-SGSN-MCC-MNC",     "mandatory": true},
                    {"tag": "SetupTime",    "field_id": "SetupTime",        "type": "*composed",    "value": "~*req.Event-Timestamp", "mandatory": true},
                    {"tag": "AnswerTime",   "field_id": "AnswerTime",       "type": "*composed",    "value": "~*req.Event-Timestamp", "mandatory": true},
                    {"tag": "Usage",        "field_id": "Usage",            "type": "*constant",    "value": "10485760"}
                ],
                "reply_fields": [
						{"tag": "CCATemplate", "type": "*template", "value": "*cca"},
						{"tag": "GrantedUnits", "field_id": "Multiple-Services-Credit-Control.Granted-Service-Unit.CC-Total-Octets", "type": "*constant", "value": "10485760", "mandatory": true},
						{"tag": "CCATemplate", "type": "*template", "value": "cca-custom"},
                   ]
      },
      {
                    "id": "data_update",
                    "filters": ["*string:*vars.*cmd:CCR", "*string:*req.CC-Request-Type:2", "*string:*req.Service-Context-Id:7.32251@3gpp.org"],   
                    "flags": ["*update", "*attributes"],
                    "request_fields":[
                        {"tag": "TOR",          "field_id": "ToR",            "type": "*constant", "value": "*data",                         "mandatory": true},
                        {"tag": "OriginHost",   "field_id": "OriginHost",     "type": "*composed", "value": "~*req.Origin-Host",             "mandatory": true},
                        {"tag": "OriginID",     "field_id": "OriginID",       "type": "*composed", "value": "~*req.Session-Id",              "mandatory": true},
                        {"tag": "RequestType",  "field_id": "RequestType",    "type": "*composed", "value": "*prepaid",                     "mandatory": true},
                        {"tag": "Direction",    "field_id": "Direction",      "type": "*composed", "value": "*out",                         "mandatory": true},
                        {"tag": "Tenant",       "field_id": "Tenant",         "type": "*composed", "value": "golant",                       "mandatory": true},
                        {"tag": "Category",     "field_id": "Category",       "type": "*composed", "value": "*attributes",                   "mandatory": true},
                        {"tag": "MSISDN",      	"field_id": "MSISDN",        "type": "*composed", "value": "~*req.Subscription-Id.Subscription-Id-Data[~Subscription-Id-Type(0)]" , "mandatory": true },
                        {"tag": "MCCMNC",  		"field_id": "MCCMNC",    "type": "*composed", "value": "~*req.Service-Information.PS-Information.3GPP-SGSN-MCC-MNC", "mandatory": true},
                        {"tag": "SetupTime",    "field_id": "SetupTime",      "type": "*composed", "value": "~*req.Event-Timestamp",         "mandatory": true},
                        {"tag": "AnswerTime",   "field_id": "AnswerTime",     "type": "*composed", "value": "~*req.Event-Timestamp",         "mandatory": true},
                        //{"tag": "Usage",        "field_id": "Usage",          "type": "*composed", "value": "*attributes"},
						{"tag": "Usage",        "field_id": "Usage",          "type": "*constant", "value": "10485760"},
						{"tag": "LastUsed",     "field_id": "LastUsed",       "type": "*sum", 
					        "value": "~*req.Multiple-Services-Credit-Control.Used-Service-Unit.CC-Input-Octets[~Rating-Group(1)];~*req.Multiple-Services-Credit-Control.Used-Service-Unit.CC-Output-Octets[~Rating-Group(1)]"},
                    ],
                    "reply_fields": [
						{"tag": "CCATemplate", "type": "*template", "value": "*cca"},
						{"tag": "GrantedUnits", "field_id": "Multiple-Services-Credit-Control.Granted-Service-Unit.CC-Total-Octets", "type": "*constant", "value": "10485760", "mandatory": true},
						{"tag": "CCATemplate", "type": "*template", "value": "cca-custom"},
                   ]
      },
      {
                    "id": "data_terminate",
                    "filters": ["*string:*vars.*cmd:CCR", "*string:*req.CC-Request-Type:3", "*string:*req.Service-Context-Id:7.32251@3gpp.org"],
                    "flags": ["*terminate", "*attributes", "*cdrs"],
                    "request_fields":[
                        {"tag": "TOR",                                 "field_id": "ToR",                              "type": "*constant",     "value": "*data",                 "mandatory": true},
						{"tag": "OriginHost",                          "field_id": "OriginHost",                       "type": "*composed",     "value": "~*req.Origin-Host",   "mandatory": true},
                        {"tag": "OriginID",                            "field_id": "OriginID",                         "type": "*composed",     "value": "~*req.Session-Id",    "mandatory": true},
                        {"tag": "RequestType",                         "field_id": "RequestType",                      "type": "*composed",     "value": "*prepaid",              "mandatory": true},
                        {"tag": "Direction",                           "field_id": "Direction",                        "type": "*composed",     "value": "*out",                  "mandatory": true},
                        {"tag": "Tenant",                              "field_id": "Tenant",                           "type": "*composed",     "value": "golant",                "mandatory": true},
                        {"tag": "Category",                            "field_id": "Category",                         "type": "*composed",     "value": "*attributes",               "mandatory": true},
                        {"tag": "MSISDN",                             	"field_id": "MSISDN",                          "type": "*composed",     "value": "~*req.Subscription-Id.Subscription-Id-Data[~Subscription-Id-Type(0)]" , "mandatory": true },
                        {"tag": "MCCMNC",                         		"field_id": "MCCMNC",                      	   "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-SGSN-MCC-MNC", "mandatory": true},
                        {"tag": "SetupTime",                           "field_id": "SetupTime",                        "type": "*composed",     "value": "~*req.Event-Timestamp",     "mandatory": true},
                        {"tag": "AnswerTime",                          "field_id": "AnswerTime",                       "type": "*composed",     "value": "~*req.Event-Timestamp",     "mandatory": true},
                        {"tag": "Reporting-Reason",                    "field_id": "Reporting-Reason",                 "type": "*composed",     "value": "~*req.Multiple-Services-Credit-Control.3GPP-Reporting-Reason[~Rating-Group(1)]", "mandatory": false},
                        {"tag": "Termination-Cause",                   "field_id": "Termination-Cause",                "type": "*composed",     "value": "~*req.Termination-Cause", "mandatory": false},
                        {"tag": "LastUsed",     "field_id": "LastUsed",       "type": "*sum", 
					       "value": "~*req.Multiple-Services-Credit-Control.Used-Service-Unit.CC-Input-Octets[~Rating-Group(1)];~*req.Multiple-Services-Credit-Control.Used-Service-Unit.CC-Output-Octets[~Rating-Group(1)]"}, 
						{"tag": "Called-Station-Id",                   "field_id": "Called-Station-Id",                "type": "*composed",     "value": "~*req.Service-Information.PS-Information.Called-Station-Id",                    "mandatory": false},
                        {"tag": "3GPP-Charging-Id",                    "field_id": "3GPP-Charging-Id",                 "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-Charging-Id",                     "mandatory": false},
                        {"tag": "3GPP-GPRS-Negotiated-QoS-profile",    "field_id": "3GPP-GPRS-Negotiated-QoS-profile", "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-GPRS-Negotiated-QoS-profile",     "mandatory": false},
                        {"tag": "3GPP-Charging-Characteristics",       "field_id": "3GPP-Charging-Characteristics",    "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-Charging-Characteristics",        "mandatory": false},
                        {"tag": "3GPP-PDP-Type",                       "field_id": "3GPP-PDP-Type",                    "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-PDP-Type",                        "mandatory": false},
                        {"tag": "GPP-SGSN-MCC-MNC",                    "field_id": "3GPP-SGSN-MCC-MNC",                "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-SGSN-MCC-MNC",                    "mandatory": false},
                        {"tag": "3GPP-GGSN-MCC-MNC",                   "field_id": "3GPP-GGSN-MCC-MNC",                "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-GGSN-MCC-MNC",                    "mandatory": false},
                        {"tag": "3GPP-NSAPI",                          "field_id": "3GPP-NSAPI",                       "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-NSAPI",                           "mandatory": false},
                        {"tag": "3GPP-Session-Stop-Indicator",         "field_id": "3GPP-Session-Stop-Indicator",      "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-Session-Stop-Indicator",          "mandatory": false},
						{"tag": "3GPP-MS-TimeZone",                    "field_id": "3GPP-MS-TimeZone",                 "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-MS-TimeZone",                     "mandatory": false},
                        {"tag": "3GPP-Selection-Mode",                 "field_id": "3GPP-Selection-Mode",              "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-Selection-Mode",                  "mandatory": false},
                        {"tag": "3GPP-RAT-Type",                       "field_id": "3GPP-RAT-Type",                    "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-RAT-Type",                        "mandatory": false},
                        {"tag": "3GPP-User-Location-Info",             "field_id": "3GPP-User-Location-Info",          "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-User-Location-Info",              "mandatory": false},
                        {"tag": "PDP-Address",                         "field_id": "PDP-Address",                      "type": "*composed",     "value": "~*req.Service-Information.PS-Information.PDP-Address",                          "mandatory": false},
                        {"tag": "3GPP-IMSI-MCC-MNC",                   "field_id": "3GPP-IMSI-MCC-MNC",                "type": "*composed",     "value": "~*req.Service-Information.PS-Information.3GPP-IMSI-MCC-MNC",                    "mandatory": false},
                        {"tag": "GGSN-Address",                        "field_id": "GGSN-Address",                     "type": "*composed",     "value": "~*req.Service-Information.PS-Information.GGSN-Address",                         "mandatory": false},
                        {"tag": "SGSN-Address",                        "field_id": "SGSN-Address",                     "type": "*composed",     "value": "~*req.Service-Information.PS-Information.SGSN-Address",                         "mandatory": false},
                        //{"tag": "Charging-Rule-Base-Name",             "field_id": "Charging-Rule-Base-Name",          "type": "*composed",     "value": "~*req.Service-Information.PS-Information.Charging-Rule-Base-Name",              "mandatory": false},
                        //{"tag": "PDP-Context-Type",                    "field_id": "PDP-Context-Type",                 "type": "*composed",     "value": "~*req.Service-Information.PS-Information.PDP-Context-Type",                     "mandatory": false}
                    ],
					"reply_fields": [
						{"tag": "CCATemplate", "type": "*template", "value": "*cca"}
						]
                }
        ],
    }
}